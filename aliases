#! /bin/sh

alias ..='cd ..'
alias huhu='echo -e "\a"'
alias la='ls -AF'
alias lf='ls -F'
alias ll='ls -AhlF'
alias mkdir='mkdir -p'

test -x "$(command -v ag)"    && alias ag='ag --nocolor'
test -x "$(command -v emacs)" && alias emacs='emacs -nw'
test -x "$(command -v nvim)"  && alias n=nvim
test -x "$(command -v tmux)"  && alias t=tmux
test -x "$(command -v vim)"   && alias v=vim

if [ -x "$(command -v git)" ]
then
    alias g=git
    alias git-watch='watch --color git diff --minimal --ignore-all-space --color'
    alias git-graph='git log --graph --pretty=format:"%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)<%an>%Creset" --abbrev-commit'
    alias git-incoming='git fetch && git log master..origin/master'
fi

if [ -x "$(command -v youtube-dl)" ]
then
    yt-dl()
    {
        youtube-dl --add-metadata -f 'bestvideo[height<=1080]+bestaudio' "$@"
    }

    yt-pl()
    {
        youtube-dl --add-metadata -f 'bestvideo[height<=1080]+bestaudio' -i -o '%(playlist_index)03d-%(title)s.%(ext)s' "$@"
    }
fi

if [ -x "$(command -v locate)" ] && [ -x "$(command -v fzf)" ]
then
    _fcd_only_dirs()
    {
        while read -r f
        do
            test -d "$f" && echo "$f"
        done
    }

    _fcd_choose_dir()
    {
        locate -b "$1" \
            | grep -v '/\.' \
            | _fcd_only_dirs \
            | fzf -1 --reverse --height=20 --history="${XDG_CACHE_HOME:-$HOME/.cache}/fcd.history"
    }

    fcd()
    {
        dir="$(_fcd_choose_dir "$1")" && cd "$dir"
    }
fi
